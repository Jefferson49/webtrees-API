{
    "openapi": "3.1.0",
    "info": {
        "title": "webtrees API",
        "version": "1.0.0-beta"
    },
    "servers": [
        {
            "url": "https://127.0.0.1/webtrees/api",
            "description": "webtrees server"
        }
    ],
    "paths": {
        "/create-record": {
            "post": {
                "tags": [
                    "webtrees"
                ],
                "operationId": "ca67c1f6c7d94bf4c7dd5a85ce085e8a",
                "parameters": [
                    {
                        "name": "tree",
                        "in": "query",
                        "description": "The name of the tree.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "maxLength": 1024,
                            "pattern": "^[^<>:\\\"\\/\\|?*\\r\\n]+$",
                            "example": "mytree"
                        }
                    },
                    {
                        "name": "record-type",
                        "in": "query",
                        "description": "The type of the GEDCOM record to create.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "maxLength": 4,
                            "pattern": "^[_A-Z][_A-Z0-9]*$",
                            "enum": [
                                "FAM",
                                "INDI",
                                "OBJE",
                                "NOTE",
                                "REPO",
                                "SOUR",
                                "SUBM"
                            ],
                            "example": "INDI"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": ""
                    },
                    "201": {
                        "description": "Created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Xref"
                                }
                            }
                        }
                    },
                    "401": {
                        "$ref": "#/components/responses/401",
                        "description": "Unauthorized: Missing authorization header or bearer token."
                    },
                    "403": {
                        "$ref": "#/components/responses/403",
                        "description": "Unauthorized: Insufficient permissions."
                    },
                    "406": {
                        "$ref": "#/components/responses/406",
                        "description": "Not acceptable"
                    },
                    "429": {
                        "$ref": "#/components/responses/429",
                        "description": "Too many requests"
                    },
                    "500": {
                        "$ref": "#/components/responses/429",
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/gedcom-data": {
            "get": {
                "tags": [
                    "webtrees"
                ],
                "operationId": "8dfda714183597605f66acc9d5e6e9d6",
                "parameters": [
                    {
                        "name": "tree",
                        "in": "query",
                        "description": "The name of the tree.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "maxLength": 1024,
                            "pattern": "^[^<>:\\\"\\/\\|?*\\r\\n]+$",
                            "example": "mytree"
                        }
                    },
                    {
                        "name": "xref",
                        "in": "query",
                        "description": "The XREF (i.e. GEDOM cross-reference identifier) of the record to retrieve.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "maxLength": 20,
                            "pattern": "^[A-Za-z0-9:_.-]{1,20}$",
                            "example": "X1234"
                        }
                    },
                    {
                        "name": "format",
                        "in": "query",
                        "description": "The format of the output. Possible values are \"gedcom\" (GEDCOM 5.5.1), \"gedcom-x\" (default; a JSON GEDCOM format defined by Familysearch), and \"json\" (identical to gedcom-x).",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "default": "gedcom-x",
                            "enum": [
                                "gedcom",
                                "gedcom-x",
                                "json"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The GEDCOM data of a record in webtrees",
                        "content": {
                            "application/text": {
                                "schema": {
                                    "description": "The GEDCOM 5.5.1 data of a record in webtrees",
                                    "type": "string",
                                    "example": "0 @X1234@ INDI\n1 NAME John /Doe/\n1 BIRT\n2 DATE 19 FEB 1870\n"
                                }
                            },
                            "application/json": {
                                "schema": {
                                    "description": "The GEDCOM-X data of a record in webtrees",
                                    "type": "object"
                                },
                                "example": {
                                    "persons": [
                                        {
                                            "id": "X1234",
                                            "names": [
                                                {
                                                    "nameForms": [
                                                        {
                                                            "fullText": "John Doe"
                                                        }
                                                    ]
                                                }
                                            ],
                                            "facts": [
                                                {
                                                    "type": "http://gedcomx.org/Birth",
                                                    "date": {
                                                        "original": "19 FEB 1870"
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "400": {
                        "$ref": "#/components/responses/400",
                        "description": "Invalid format parameter."
                    },
                    "401": {
                        "$ref": "#/components/responses/401",
                        "description": "Unauthorized: Missing authorization header or bearer token."
                    },
                    "403": {
                        "$ref": "#/components/responses/403",
                        "description": "Unauthorized: Insufficient permissions."
                    },
                    "404": {
                        "$ref": "#/components/responses/404",
                        "description": "Not found: Tree does not exist, or no matching GEDCOM record found for XREF."
                    },
                    "406": {
                        "$ref": "#/components/responses/406",
                        "description": "Not acceptable"
                    },
                    "429": {
                        "$ref": "#/components/responses/429",
                        "description": "Too many requests"
                    },
                    "500": {
                        "$ref": "#/components/responses/429",
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/search-general": {
            "get": {
                "tags": [
                    "webtrees"
                ],
                "operationId": "8da2970376403615ebe4b6916c648ba7",
                "parameters": [
                    {
                        "name": "tree",
                        "in": "query",
                        "description": "The name of the tree. If not provided, all trees will be searched.",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "maxLength": 1024,
                            "pattern": "^[^<>:\\\"\\/\\|?*\\r\\n]+$",
                            "example": "mytree"
                        }
                    },
                    {
                        "name": "query",
                        "in": "query",
                        "description": "The search query.",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "maxLength": 8192
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The result of a general search in webtrees. The result contains a list of records, each with the tree name and the XREF of the record.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "required": [
                                        "records"
                                    ],
                                    "properties": {
                                        "records": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/WebtreesSearchResultItem"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "$ref": "#/components/responses/400",
                        "description": "Invalid tree or query parameter."
                    },
                    "401": {
                        "$ref": "#/components/responses/401",
                        "description": "Unauthorized: Missing authorization header or bearer token."
                    },
                    "403": {
                        "$ref": "#/components/responses/403",
                        "description": "Unauthorized: Insufficient permissions."
                    },
                    "404": {
                        "$ref": "#/components/responses/404",
                        "description": "Not found: Tree does not exist."
                    },
                    "406": {
                        "$ref": "#/components/responses/406",
                        "description": "Not acceptable"
                    },
                    "429": {
                        "$ref": "#/components/responses/429",
                        "description": "Too many requests"
                    },
                    "500": {
                        "$ref": "#/components/responses/429",
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/trees": {
            "get": {
                "tags": [
                    "webtrees"
                ],
                "operationId": "a5ec69f29847e4994462caba009a57fa",
                "responses": {
                    "200": {
                        "description": "A list of the available trees",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "required": [
                                        "trees"
                                    ],
                                    "properties": {
                                        "trees": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/TreeItem"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "$ref": "#/components/responses/401",
                        "description": "Unauthorized: Missing authorization header or bearer token."
                    },
                    "403": {
                        "$ref": "#/components/responses/403",
                        "description": "Unauthorized: Insufficient permissions."
                    },
                    "406": {
                        "$ref": "#/components/responses/406",
                        "description": "Not acceptable"
                    },
                    "429": {
                        "$ref": "#/components/responses/429",
                        "description": "Too many requests"
                    },
                    "500": {
                        "$ref": "#/components/responses/429",
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/version": {
            "get": {
                "tags": [
                    "webtrees"
                ],
                "operationId": "933f892564f46241fb22542d565683cd",
                "responses": {
                    "200": {
                        "description": "The webtrees version used",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/WebtreesVersionItem"
                                }
                            }
                        }
                    },
                    "401": {
                        "$ref": "#/components/responses/401",
                        "description": "Unauthorized: Missing authorization header or bearer token."
                    },
                    "403": {
                        "$ref": "#/components/responses/403",
                        "description": "Unauthorized: Insufficient permissions."
                    },
                    "406": {
                        "$ref": "#/components/responses/406",
                        "description": "Not acceptable"
                    },
                    "429": {
                        "$ref": "#/components/responses/429",
                        "description": "Too many requests"
                    },
                    "500": {
                        "$ref": "#/components/responses/429",
                        "description": "Internal server error"
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "TreeItem": {
                "title": "TreeItem",
                "description": "A tree item with name and title",
                "properties": {
                    "name": {
                        "description": "The name of the tree",
                        "type": "string",
                        "maxLength": 1024,
                        "pattern": "^[^<>:\"/\\|?*\r\n]+$",
                        "example": "mytree"
                    },
                    "title": {
                        "description": "The title of the tree",
                        "type": "string",
                        "maxLength": 1024,
                        "example": "My Family Tree"
                    }
                },
                "type": "object",
                "additionalProperties": false
            },
            "WebtreesSearchResultItem": {
                "title": "WebtreesSearchResultItem",
                "description": "Search result item with tree name and xref",
                "properties": {
                    "tree": {
                        "description": "The name of the tree, to which the record belongs",
                        "type": "string",
                        "maxLength": 1024,
                        "pattern": "^[^<>:\"/\\|?*\r\n]+$",
                        "example": "mytree"
                    },
                    "xref": {
                        "description": "The XREF (i.e. GEDOM cross-reference identifier) of the record",
                        "type": "string",
                        "maxLength": 255,
                        "pattern": "^[A-Za-z0-9:_.-]{1,20}$",
                        "example": "X1234"
                    }
                },
                "type": "object",
                "additionalProperties": false
            },
            "WebtreesVersionItem": {
                "title": "WebtreesVersionItem",
                "description": "webtrees version",
                "properties": {
                    "version": {
                        "description": "webtrees version",
                        "type": "string",
                        "maxLength": 100,
                        "pattern": "^[0-9]+\\.[0-9]+(\\.[0-9]+)?(-[A-Za-z0-9]+)?$",
                        "example": "1.2.3"
                    }
                },
                "type": "object",
                "additionalProperties": false
            },
            "Xref": {
                "title": "XREF",
                "description": "A GEDCOM XREF (cross-reference identifier)",
                "properties": {
                    "XREF": {
                        "description": "The GEDCOM XREF (cross-reference identifier)",
                        "type": "string",
                        "maxLength": 20,
                        "pattern": "^[A-Za-z0-9:_.-]{1,20}$",
                        "example": "X1234"
                    }
                },
                "type": "object",
                "additionalProperties": false
            }
        },
        "responses": {
            "400": {
                "description": "400 Bad request"
            },
            "401": {
                "description": "401 Unauthorized"
            },
            "403": {
                "description": "403 Forbidden"
            },
            "404": {
                "description": "404 Not found"
            },
            "405": {
                "description": "405 Method Not Allowed"
            },
            "406": {
                "description": "406 Not acceptable"
            },
            "429": {
                "description": "429 Too many requests"
            },
            "500": {
                "description": "500 Internal server error"
            }
        },
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "description": "Basic Auth",
                "scheme": "bearer"
            }
        }
    },
    "security": [
        {
            "bearerAuth": []
        }
    ],
    "tags": [
        {
            "name": "webtrees",
            "description": "webtrees API"
        }
    ]
}